### Задача

Есть события пользователя (user_events), которые записываются в Clickhouse. Необходимо:

- поддерживать сырые логи событий со сроком хранения 30 дней
- построить агрегированную таблицу со сроком хранения 180 дней, чтобы делать трендовый анализ:
    - уникальные пользователи по event_type и event_date
    - сумма потраченных баллов
    - количество действий
- сделать Materialized View, которая:
    - при вставке данных в таблицу сырых логов событий будет обновлять агрегированную таблицу
    - использует sumState, uniqState, countState
- создать запрос, показывающий, сколько пользователей вернулись в течение следующих 7 дней
    - формат результата: total_users_day_0|returned_in_7_days|retention_7d_percent|
- создать запрос с группировками по быстрой аналитике по дням в определенном формате